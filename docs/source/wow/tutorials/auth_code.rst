.. _authorization workflow:

Using the Authorization Code Flow
=================================

.. warning::
   A web server must be configured to accept the redirect back from the Blizzard authentication servers in order to
   use any endpoint that requires the authorization workflow enabled client

.. note::
   Note that you can still use the user authorization client, with the endpoints that accept the client credentials
   as well.

The Workflow
------------

#. The user goes to a login page on a site
#. The site redirects the the user to the authorization url, generated by client.authorization_url()
#. The user then successfully logs into the Battle.net authorization server, and allows access to the account
   information
#. The Battle.net server, then redirects the user back to the redirect_url


Example
-------

.. code-block:: python3

    > from wow_api.base import WoWClient
    > from wow_api.game.playable_class import playable_class
    > client = WoWClient(<region>, scope=['wow.profile'], redirect_uri=<redirt_uri>, client_id=<CLIENT_ID>,
                         client_secret=<CLIENT_SECRET>)

    # Once the client has been instantiated, then system will redirect the user to the Battle.net authorization URL
    > redirect(client.authorization_url())

    # Assuming the user was successfully authenticated with Battle.net, they will be redirected back to <redirect_uri>
    # there the server will process the callback request, and then you can access the API as normal
    > client.playable_class.playable_class('en_US', 7)

    # returns the data for the shaman class
    {'_links': {'self': {'href': 'https://us.api.blizzard.com/data/wow/playable-class/...