.. _auth code flow:

Using the Authorization Code Flow
=================================

.. warning::
   A web server must be configured to accept the redirect back from the Blizzard authentication servers in order to
   use any endpoint that requires the authorization workflow enabled client

.. note::
   Note that you can still use the user authorization client, with the endpoints that accept the client credentials
   as well.

The Workflow
------------

#. The user goes to a login page on a site
#. The site redirects the the user to the authorization url, generated by client.authorization_url()
#. The user then successfully logs into the Battle.net authorization server, and allows access to the account
   information
#. The Battle.net server, then redirects the user back to the redirect_url


Example
-------

.. code-block:: python3

    > from battlenet_client import wow
    > client = wow.WoWClient(<region>, scope=['wow.profile'], redirect_uri=<redirect_uri>,
                             client_id=<CLIENT_ID>, client_secret=<CLIENT_SECRET>)

    # Once the client has been instantiated, then the have the code redirect the user to the authorization URL
    > redirect(client.authorization_url())

    # Assuming the user was successfully authenticated with Battle.net, they will be redirected back to <redirect_uri>
    # there the server will process the callback request, and then you can access the API as normal
    > client.playable_class.playable_class('en_US', 7)
    # returns the data for the shaman class
    {'_links': {'self': {'href': 'https://us.api.blizzard.com/data/wow/playable-class/...
    > client.account.account_profile_summary('en_US')
    # returns data about the account (assuming the user has authorized your application to access it)
    {"_links": {"self": {"href": "https://us.api.blizzard.com/profile/user/wow?namespace=profile-us"}, ...
